<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="alternate"
      type="application/rss+xml"
      href="https://dou-meishi.github.io/org-blog/rss.xml"
      title="RSS feed for https://dou-meishi.github.io/org-blog/">
<title>斗地主中的概率</title>
<meta name="author" content="Dou Meishi">
<meta name="referrer" content="no-referrer">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="google-site-verification" content="_Ly4i8BW_CWeGaFdsQgJ2xN-yOkGpSDnLw8LitvkEsw" />
<link rel="stylesheet" type="text/css" href="https://gongzhitaao.org/orgcss/org.css"/>
<link rel="stylesheet" type="text/css" href="https://dou-meishi.github.io/orgcss/dou-new-org.css"/>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: "85%"
      },
      tags: "ams",
      tagSide: "right",
      tagIndent: ".8em"
    },
    output: {
      font: "mathjax-stix2",
      scale: "1.2",
      mtextFont: "sans-serif",
      displayAlign: "center",
      displayIndent: "0em",
      displayOverflow: "overflow"
    },
    loader: {
      load: ["ui/lazy"]
    },
  };
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-chtml.js"></script>
<!-- Additional CSS for my blog site -->
<link rel="stylesheet" type="text/css" href="https://dou-meishi.github.io/org-blog/static/blog.css"/>
</head>
<body>
<div id="preamble" class="status"><div class="header">
  <div class="sitelinks">
    <a href="https://dou-meishi.github.io/org-blog/index.html">Home</a>
    |
    <a href="https://dou-meishi.github.io/org-blog/archive.html">All Posts</a>
  </div>
</div>
</div>
<div id="content">
<div class="post-date">17 Jul 2022</div><h1 class="post-title"><a href="https://dou-meishi.github.io/org-blog/2022-07-17-PokerProbability/notes.html">斗地主中的概率</a></h1>
<nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orge93afb8">小球模型</a></li>
<li><a href="#orgfe3a9d1">事件模型</a></li>
<li><a href="#org9878ec4">模型应用</a></li>
<li><a href="#org09273f8">进阶应用</a></li>
</ul>
</div>
</nav>
<div id="outline-container-orge93afb8" class="outline-2">
<h2 id="orge93afb8"><a href="#orge93afb8">小球模型</a></h2>
<div class="outline-text-2" id="text-orge93afb8">
<p>
<b>问.</b> 现有 \(N\) 个小球, 其中有 \(M\) 个作了标记. 今随机地挑出 \(K\) 个, 写出其中标记球的个数的分布.
</p>

<p>
<b>答</b>. 为了问题有意义，我们不妨要求 \(N, M, K \geq 1\)，且 \(N\geq M\) 和 \(N\geq K\).
</p>

<p>
记挑出标记球的个数为 \(X\), 那么必然有 \(X \leq K\) 和 \(X \leq M\)，以及\(X
\geq 0\). 另外，如果绝大多数球都被标记，那么只要挑出的球不至于太少 \(K >
N-M\)，那么一定有被标记的球. 换而言之，\(X\) 的最小取值未必是零，也可能是
\(K - (N - M)\). 如此不难看出 \(X\) 的可能取值为 \(\max(0, K-N+M)\) 到
\(\min(K, M)\) 中间的任何值.
</p>

<p>
\[ \mathbb{P}(X=i) = \frac{
\binom{M}{i}\binom{N-M}{K-i}}{\binom{N}{K}},\qquad \max(0,K+M-N)\leq
i\leq \min(K,M). \]
</p>

<p>
<b>注.</b> 设 \(N, M, K\) 是大于 1 的正整数, 且有 \(N\geq M\) 和 \(N\geq K\), 那么有恒等式
\[ \sum_{i=\max(0,K+M-N)}^{\min(K,M)}\binom{M}{i}\binom{N-M}{K-i} = \binom{N}{K}.\]
</p>

<p>
<b>例 1.</b> 取 \(N=54,M=6,K=20\), 则 \(X\) 分布如下
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">\(X\)</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">\(p\)</td>
<td class="org-right">0.052</td>
<td class="org-right">0.22</td>
<td class="org-right">0.34</td>
<td class="org-right">0.26</td>
<td class="org-right">0.11</td>
<td class="org-right">0.02</td>
<td class="org-right">0.0015</td>
</tr>
</tbody>
</table>

<p>
<b>例 2.</b> 取 \(N=54,M=6,K=17\), 则 \(X\) 分布如下
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">\(X\)</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">\(p\)</td>
<td class="org-right">0.09</td>
<td class="org-right">0.29</td>
<td class="org-right">0.35</td>
<td class="org-right">0.2</td>
<td class="org-right">0.061</td>
<td class="org-right">0.0089</td>
<td class="org-right">0.00048</td>
</tr>
</tbody>
</table>

<p>
<b>例 3.</b> 取 \(N=54,M=6,K=3\), 则 \(X\) 分布如下
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">\(X\)</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-left">\(p\)</td>
<td class="org-right">0.7</td>
<td class="org-right">0.27</td>
<td class="org-right">0.029</td>
<td class="org-right">0.00081</td>
</tr>
</tbody>
</table>

<p>
计算上述概率的代码 <a href="./balls.py">在这</a> 。
</p>
</div>
</div>
<div id="outline-container-orgfe3a9d1" class="outline-2">
<h2 id="orgfe3a9d1"><a href="#orgfe3a9d1">事件模型</a></h2>
<div class="outline-text-2" id="text-orgfe3a9d1">
<p>
<b>问.</b> 现有事件族 \(\{A_i\}_{i=1}^n\), 写出至少有一个事件发生的概率.
</p>

<p>
<b>答.</b> 记 \(S_1=\sum_i\mathbb{P}(A_i)\) 为一个事件发生的概率之和；记
\(S_2=\sum_{i < j}\mathbb{P}(A_i\cap A_j)\) 为两个不同事件发生的概率之和；
记 \[S_k=\sum_{i_1 < i_2 < \cdots < i_k}\mathbb{P}(A_{i_1} \cap
A_{i_2} \cap \cdots \cap A_{i_k})\] 为 \(k\) 个不同事件发生概率之和；则
有 \[\mathbb{P}\biggl(\bigcup_{i=1}^nA_i\biggr)=S_1 - S_2 + S_3 -
\cdots + (-1)^{n+1}S_n.\]
</p>

<p>
<b>证.</b> 对 \(n\) 作数学归纳法。显然 \(n=2\) 时命题成立。假设命题对 \(n\) 成立，
下面证命题对 \(n+1\) 成立。
</p>

<p>
为清晰起见，用 \(S_k(\mathcal{E})\) 记事件族 \(\mathcal{E}=\{E_i\}\) 中
\(k\) 个不同事件发生概率之和。令 \(\mathcal{A}_n = \{A_i\}_{i=1}^n\) 及
\(\mathcal{A}_{n+1}=\{A_i\}_{i=1}^{n+1}\). 那么已知 \[
\mathbb{P}\biggl(\bigcup_{i=1}^nA_i\biggr)=S_1(\mathcal{A}_n) -
S_2(\mathcal{A}_n) + S_3(\mathcal{A}_n) - \cdots +
(-1)^{n+1}S_n(\mathcal{A}_n). \] 欲证 \[
\mathbb{P}\biggl(\bigcup_{i=1}^{n+1}
A_i\biggr)=S_1(\mathcal{A}_{n+1}) - S_2(\mathcal{A}_{n+1}) +
S_3(\mathcal{A}_{n+1}) - \cdots + (-1)^{n+1}S_n(\mathcal{A}_{n+1}). \]
</p>

<p>
不难看出 \[ \mathbb{P}\biggl(\bigcup_{i=1}^{n+1} A_i\biggr) =
\mathbb{P}(A_{n+1}) + \mathbb{P}\biggl(\bigcup_{i=1}^{n} A_i\biggr) -
\mathbb{P}\biggl(\bigcup_{i=1}^{n} (A_i\cap A_{n+1})\biggr). \]
</p>

<p>
令 \(\mathcal{B} = \{A_i\cap A_{n+1}\}_{i=1}^n\). 那么
</p>

$$
\begin{aligned}
\mathbb{P}\biggl(\bigcup_{i=1}^{n+1} A_i\biggr)
=& \mathbb{P}(A_{n+1}) + S_1(\mathcal{A}_n) \\
& - S_1(\mathcal{B}) - S_2(\mathcal{A}_n) \\
& + S_2(\mathcal{B}) + S_3(\mathcal{A}_n) \\
& - S_3(\mathcal{B}) - S_4(\mathcal{A}_n) \\
& \cdots \\
& +(-1)^{n+1}S_{n-1}(\mathcal{B}) + (-1)^{n+1}S_n(\mathcal{A}_n) \\
& +(-1)^{n+2}S_{n}(\mathcal{B}).
\end{aligned}
$$

<p>
注意到 \(S_k(\mathcal{B}) + S_{k+1}(\mathcal{A}_n) = S_{k+1}(\mathcal{A}_{n+1})\)
即完成证明。
</p>
</div>
</div>
<div id="outline-container-org9878ec4" class="outline-2">
<h2 id="org9878ec4"><a href="#org9878ec4">模型应用</a></h2>
<div class="outline-text-2" id="text-org9878ec4">
<p>
以下考虑经典规则: 54 张牌, 地主分到 20 张, 两个农民各 17 张.
</p>

<ol class="org-ol">
<li><p>
摸到王牌的概率
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">个数</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-left">地主</td>
<td class="org-right">0.39</td>
<td class="org-right">0.48</td>
<td class="org-right">0.13</td>
</tr>

<tr>
<td class="org-left">农民</td>
<td class="org-right">0.47</td>
<td class="org-right">0.44</td>
<td class="org-right">0.095</td>
</tr>
</tbody>
</table></li>

<li><p>
摸到 2 的概率
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">个数</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
</tr>

<tr>
<td class="org-left">地主</td>
<td class="org-right">0.15</td>
<td class="org-right">0.38</td>
<td class="org-right">0.34</td>
<td class="org-right">0.12</td>
<td class="org-right">0.015</td>
</tr>

<tr>
<td class="org-left">农民</td>
<td class="org-right">0.21</td>
<td class="org-right">0.42</td>
<td class="org-right">0.29</td>
<td class="org-right">0.08</td>
<td class="org-right">0.0075</td>
</tr>
</tbody>
</table></li>

<li><p>
摸到王牌或者 2 的概率
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-left">个数</td>
<td class="org-right">0</td>
<td class="org-right">1</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">4</td>
<td class="org-right">5</td>
<td class="org-right">6</td>
</tr>

<tr>
<td class="org-left">地主</td>
<td class="org-right">0.052</td>
<td class="org-right">0.22</td>
<td class="org-right">0.34</td>
<td class="org-right">0.26</td>
<td class="org-right">0.11</td>
<td class="org-right">0.02</td>
<td class="org-right">0.0015</td>
</tr>

<tr>
<td class="org-left">农民</td>
<td class="org-right">0.09</td>
<td class="org-right">0.29</td>
<td class="org-right">0.35</td>
<td class="org-right">0.2</td>
<td class="org-right">0.061</td>
<td class="org-right">0.0089</td>
<td class="org-right">0.00048</td>
</tr>
</tbody>
</table></li>
</ol>
</div>
</div>
<div id="outline-container-org09273f8" class="outline-2">
<h2 id="org09273f8"><a href="#org09273f8">进阶应用</a></h2>
<div class="outline-text-2" id="text-org09273f8">
<p>
<b>问.</b> 写出经典规则下地主摸到至少一炸 (王炸或者四炸) 的概率. 农民呢?
</p>

<p>
<b>答</b>. 记 \(A_0\) 为事件 "地主摸到王炸", \(A_i\) 为事件 "地主摸到炸 \(i\)" (\(i=1,2,\ldots,13\)). 记 \(a_m\) 为从一组有 \(m\) 个标记球共 54 个球的球堆中取出 20 个球时恰好有 \(m\) 个标记球的概率. 那么 \[\mathbb{P}(A_0)=a_2,\qquad \mathbb{P}(A_i) = a_4,\quad i=1,2,\ldots,13.\] 进一步地, 有
</p>

$$
\begin{aligned}
S_1 &= \sum_{i=0}^{13}\mathbb{P}(A_i) = a_2 + 13 a_4,\\
S_2 &= \sum_{0\leq i < j \leq 13}\mathbb{P}(A_i\cap A_j) = \biggl( \sum_{\substack{1\leq j \leq 13\\i=0}} + \sum_{1\leq i <  j \leq 13} \biggr)\mathbb{P}(A_i\cap A_j)= 13 a_6 + \binom{13}{2}a_8,\\
S_3 &= \sum_{0\leq i < j < k \leq 13}\mathbb{P}(A_i\cap A_j\cap A_k) = \biggl( \sum_{\substack{1\leq j < k \leq 13\\i=0}} + \sum_{1\leq i <  j < k \leq 13} \biggr)\mathbb{P}(\cdots)= \binom{13}{2}a_{10} + \binom{13}{3}a_{12},\\
S_4 &= \sum_{0\leq i < j < k < \ell \leq 13}\mathbb{P}(\cdots) = \biggl( \sum_{\substack{1\leq j < k < \ell \leq 13\\i=0}} + \sum_{1\leq i <  j < k < \ell \leq 13} \biggr)\mathbb{P}(\cdots)= \binom{13}{3}a_{14} + \binom{13}{4}a_{16},\\
\cdots & \cdots,\\
S_k &= \binom{13}{k-1}a_{4k-2} + \binom{13}{k}a_{4k}.
\end{aligned}
$$

<p>
显然, 当 \(k \geq 6\) 时, \(S_k=0\). 故 \[\mathbb{P}\biggl(\bigcup_{i=0}^{13}A_i\biggr) = S_1 - S_2 + S_3 - S_4 + S_5 \approx 30.4\%.\]
对于农民, 这个数字变为
\[\mathbb{P}\biggl(\bigcup_{i=0}^{13}A'_i\biggr) = S'_1 - S'_2 + S'_3 - S'_4\approx 18.5\%.\]
</p>

<p>
模拟验证的代码 <a href="./bombs.py">在这</a> 。
</p>
</div>
</div>
<div class="taglist"><a href="https://dou-meishi.github.io/org-blog/tags.html">Tags</a>: <a href="https://dou-meishi.github.io/org-blog/tag-math.html">math</a> </div>
<div id="comments"><script src="https://giscus.app/client.js"
        data-repo="Dou-Meishi/org-blog"
        data-repo-id="R_kgDOLJfSOw"
        data-category="Announcements"
        data-category-id="DIC_kwDOLJfSO84CkxDd"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="light"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
</div></div>
<div id="postamble" class="status">Created by <a href="https://github.com/bastibe/org-static-blog/">Org Static Blog</a>
</div>
</body>
</html>
